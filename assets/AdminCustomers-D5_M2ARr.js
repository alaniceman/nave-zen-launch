import{u as b,r as d,j as e,I as f,M as y,s as N}from"./index-DObZXVZK.js";import{u as S}from"./useQuery-BlPr6VYC.js";import{B as v}from"./badge-DwWoThsR.js";import{S as w,a as C,b as T,c as k,d as m}from"./select-DIyBVs-v.js";import{T as _,a as E,b as i,c as l,d as M,e as s}from"./table-CxlGZG7o.js";import{S as B}from"./search-BPjlDn2i.js";import{k as L,n as $}from"./es-BGq_Vek6.js";import"./index-2SUt3H7s.js";import"./index-Ccv4wA_7.js";import"./chevron-up-DbqdR62P.js";import"./check-BvYsMp3D.js";const x={new:"Nuevo",trial_booked:"Prueba agendada",trial_attended:"Prueba asistida",purchased:"Comprador",member:"Miembro"},q={new:"bg-gray-100 text-gray-700",trial_booked:"bg-blue-100 text-blue-700",trial_attended:"bg-yellow-100 text-yellow-700",purchased:"bg-green-100 text-green-700",member:"bg-purple-100 text-purple-700"};function Q(){const h=b(),[t,u]=d.useState(""),[n,p]=d.useState("all"),{data:o=[],isLoading:g}=S({queryKey:["admin-customers",t,n],queryFn:async()=>{let a=N.from("customers").select("*").order("created_at",{ascending:!1}).limit(200);n!=="all"&&(a=a.eq("status",n)),t.trim()&&(a=a.or(`name.ilike.%${t}%,email.ilike.%${t}%,phone.ilike.%${t}%`));const{data:r,error:c}=await a;if(c)throw c;return r}}),j=a=>a?`https://wa.me/${a.replace(/[^0-9]/g,"")}`:null;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Clientes"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(B,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(f,{placeholder:"Buscar por nombre, email o teléfono...",value:t,onChange:a=>u(a.target.value),className:"pl-10"})]}),e.jsxs(w,{value:n,onValueChange:p,children:[e.jsx(C,{className:"w-48",children:e.jsx(T,{placeholder:"Estado"})}),e.jsxs(k,{children:[e.jsx(m,{value:"all",children:"Todos"}),Object.entries(x).map(([a,r])=>e.jsx(m,{value:a,children:r},a))]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border overflow-x-auto",children:e.jsxs(_,{children:[e.jsx(E,{children:e.jsxs(i,{children:[e.jsx(l,{children:"Nombre"}),e.jsx(l,{children:"Email"}),e.jsx(l,{children:"Celular"}),e.jsx(l,{children:"Estado"}),e.jsx(l,{children:"Fecha"})]})}),e.jsx(M,{children:g?e.jsx(i,{children:e.jsx(s,{colSpan:5,className:"text-center py-8 text-gray-500",children:"Cargando..."})}):o.length===0?e.jsx(i,{children:e.jsx(s,{colSpan:5,className:"text-center py-8 text-gray-500",children:"No se encontraron clientes"})}):o.map(a=>e.jsxs(i,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>h(`/admin/clientes/${a.id}`),children:[e.jsx(s,{className:"font-medium",children:a.name}),e.jsx(s,{className:"text-sm text-gray-600",children:a.email}),e.jsx(s,{children:a.phone?e.jsxs("a",{href:j(a.phone),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-green-600 hover:text-green-700",onClick:r=>r.stopPropagation(),children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:a.phone})]}):e.jsx("span",{className:"text-gray-400 text-sm",children:"—"})}),e.jsx(s,{children:e.jsx(v,{variant:"outline",className:q[a.status]||"",children:x[a.status]||a.status})}),e.jsx(s,{className:"text-sm text-gray-500",children:L(new Date(a.created_at),"dd MMM yyyy",{locale:$})})]},a.id))})]})})]})}export{Q as default};
