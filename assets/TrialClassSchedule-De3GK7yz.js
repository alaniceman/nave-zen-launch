import{u as H,r as x,j as e,d as z,I as T,f as ae,s as ne,H as _}from"./index-C5rgRvqo.js";import{g as re,d as S,C as O}from"./schedule-CkZ46A5R.js";import{E as Y}from"./experiences-CP284GFD.js";import{u as le}from"./useScheduleEntries-rDpAPN-h.js";import{S as oe}from"./skeleton-BWQkmo3l.js";import{C as R}from"./clock-Dz-Mzols.js";import{C as Z}from"./circle-x-BlpFppCY.js";import{A as G}from"./arrow-left-BOU29GrS.js";import{C as ie}from"./calendar-DmMWJ57x.js";import{M as ce}from"./map-pin-Bn-nhjtw.js";import{u as de}from"./index.esm-lhlJqsim.js";import{o as me,s as L,t as xe}from"./zod-Bk3Ra2iQ.js";import{F as ue,a as $,b as P,c as M,d as V,e as B}from"./form-C5the1yY.js";import{u as W}from"./useFacebookConversionsAPI-DRqP47Bs.js";import{T as he}from"./triangle-alert-CgKB7836.js";import{C as pe}from"./circle-check-big-CkOLHsSd.js";import"./useQuery-0oj_cgUk.js";import"./label-BeSNDpt8.js";const C=["lunes","martes","miercoles","jueves","viernes","sabado","domingo"],be=s=>{switch(s){case"wim-hof":return"bg-[#35C7D2]";case"yoga":return"bg-[#2E4D3A]";case"hiit":return"bg-[#C49A6C]";case"breathwork":return"bg-[#7AA6A0]";case"personalizado":return"bg-[#8C7A6B]";default:return"bg-[#35C7D2]"}};function ge({onSelectClass:s}){const c=H(),{data:d,isLoading:m}=le(),r=(d==null?void 0:d.scheduleData)||{},l=new URLSearchParams(typeof window<"u"?window.location.search:""),o=l.get("view")==="exp"?"exp":"day",[i,b]=x.useState(o),[g,u]=x.useState(l.get("exp")||"yoga"),[f,N]=x.useState(""),[h,n]=x.useState(""),[v,y]=x.useState(null),[D,A]=x.useState(null),q=50;x.useEffect(()=>{const t=re();n(t),N(t)},[]);const E=[{key:"lunes",label:"Lun"},{key:"martes",label:"Mar"},{key:"miercoles",label:"MiÃ©"},{key:"jueves",label:"Jue"},{key:"viernes",label:"Vie"},{key:"sabado",label:"SÃ¡b"},{key:"domingo",label:"Dom"}],k=()=>f||h,J=r[k()]||[],Q=S[k()]||"",U=i==="exp"?(()=>{const t=Y.find(a=>a.slug===g);return t?C.map(a=>{const p=(r[a]||[]).filter(w=>t.match(w)).sort((w,F)=>w.time.localeCompare(F.time));return{day:a,dayName:S[a],items:p}}).filter(a=>a.items.length>0):[]})():[],I=t=>{A(null),y(t.targetTouches[0].clientX)},K=t=>{A(t.targetTouches[0].clientX)},ee=()=>{if(!v||!D)return;const t=v-D;if(Math.abs(t)>q){const a=E.findIndex(p=>p.key===f);let j=a;t>0&&a<E.length-1?j=a+1:t<0&&a>0&&(j=a-1),j!==a&&N(E[j].key)}},X=(t,a)=>{t.is_trial_enabled?s(t,a):c("/agenda-nave-studio")};if(m)return e.jsx("section",{className:"py-4 md:py-8",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 md:px-6 space-y-4",children:[...Array(4)].map((t,a)=>e.jsx(oe,{className:"h-32 w-full rounded-2xl"},a))})});const te=(t,a,j,p=!1)=>{var w;return e.jsxs("div",{className:`${be(t.color_tag)} text-white rounded-2xl px-4 py-4 md:px-5 md:py-5 shadow-sm relative`,children:[p&&e.jsx("div",{className:"lg:hidden absolute top-3 right-3 text-xs font-medium text-white/80 bg-black/20 px-2 py-1 rounded backdrop-blur",children:(w=S[a])==null?void 0:w.slice(0,3).toUpperCase()}),e.jsxs("div",{className:"flex items-center gap-2 text-white/90 text-xl md:text-2xl font-semibold mb-2 pr-12 lg:pr-0",children:[e.jsx(R,{className:"w-5 h-5 md:w-6 md:h-6"}),t.time,t.instructor&&e.jsxs("span",{className:"text-sm font-normal text-white/70 ml-2",children:["con ",t.instructor]})]}),e.jsx("h3",{className:"text-white font-semibold text-lg md:text-xl leading-tight line-clamp-2 mb-2",children:t.title}),t.description&&e.jsx("p",{className:"text-white/80 text-sm mb-3 line-clamp-2",children:t.description}),e.jsx("div",{className:"flex flex-wrap items-center gap-2 mt-3",children:t.is_trial_enabled?e.jsx("button",{onClick:()=>X(t,a),className:"ml-auto bg-white text-[#2E4D3A] font-semibold text-sm px-4 py-2 rounded-full hover:bg-white/90 transition-colors",children:"Agendar clase de prueba"}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"inline-flex items-center gap-1 bg-white/20 text-white/80 rounded-full px-3 py-1 text-xs backdrop-blur",children:[e.jsx(Z,{className:"w-3.5 h-3.5"})," No permite clase de prueba"]}),e.jsx("button",{onClick:()=>X(t,a),className:"ml-auto bg-white/20 text-white font-medium text-sm px-4 py-2 rounded-full hover:bg-white/30 transition-colors backdrop-blur",children:"Agendar"})]})}),t.badges.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:t.badges.map((F,se)=>e.jsx("span",{className:"bg-white/20 text-white rounded-full px-3 py-1 text-sm backdrop-blur inline-flex",children:F},se))})]},`${a}-${j}`)};return e.jsx("section",{className:"py-4 md:py-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 md:px-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-6 md:mb-8",children:[e.jsx("button",{className:`px-5 py-3 rounded-full font-medium text-sm transition-all ${i==="day"?"bg-[#2E4D3A] text-white shadow-sm":"bg-white text-[#2E4D3A] border border-[#E2E8F0] hover:border-[#2E4D3A]/40 hover:bg-[#F8F9FA]"}`,onClick:()=>b("day"),children:"ðŸ“… Por DÃ­a"}),e.jsx("button",{className:`px-5 py-3 rounded-full font-medium text-sm transition-all ${i==="exp"?"bg-[#2E4D3A] text-white shadow-sm":"bg-white text-[#2E4D3A] border border-[#E2E8F0] hover:border-[#2E4D3A]/40 hover:bg-[#F8F9FA]"}`,onClick:()=>b("exp"),children:"ðŸŽ¯ Por Experiencia"})]}),i==="exp"&&e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsx("div",{className:"text-sm font-medium text-[#575757] mb-3",children:"Selecciona una experiencia:"}),e.jsx("div",{className:"flex gap-2 md:gap-3 overflow-x-auto pb-2 -mx-1 px-1 [&::-webkit-scrollbar]:hidden",children:Y.map(t=>e.jsx("button",{onClick:()=>u(t.slug),className:`shrink-0 whitespace-nowrap rounded-full px-4 py-2.5 border transition-all text-sm font-medium ${g===t.slug?"bg-[#2E4D3A] text-white border-[#2E4D3A] shadow-sm":"bg-white text-[#2E4D3A] border-[#E2E8F0] hover:border-[#2E4D3A]/40 hover:bg-[#F8F9FA]"}`,children:t.labelShort??t.label},t.slug))})]}),i==="day"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto px-0 pb-2 mb-4",role:"tablist",children:E.map(t=>e.jsx("button",{role:"tab","aria-selected":f===t.key,onClick:()=>N(t.key),className:`rounded-xl px-4 py-2.5 font-medium text-sm whitespace-nowrap transition-all ${f===t.key?"bg-[#2E4D3A] text-white shadow-sm":"bg-white text-[#2E4D3A] border border-[#E2E8F0] hover:bg-[#F8F9FA]"}`,children:t.label},t.key))}),e.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-[#2E4D3A] mb-4 flex items-center gap-2",children:[Q,f===h&&e.jsx("span",{className:"bg-[#2E4D3A] text-white rounded-full text-sm px-3 py-1",children:"Hoy"})]}),e.jsxs("div",{className:"space-y-4 md:space-y-5 animate-fade-in",onTouchStart:I,onTouchMove:K,onTouchEnd:ee,children:[J.map((t,a)=>te(t,k(),a,!0)),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>{const t=C.indexOf(f);N(C[(t+1)%C.length])},className:"bg-[#2E4D3A] text-white px-6 py-3 rounded-lg font-medium hover:bg-[#2E4D3A]/90 transition-colors",children:"Ver dÃ­a siguiente"})})]})]}):e.jsxs("div",{className:"space-y-8",children:[U.map(({day:t,dayName:a,items:j})=>e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm",children:[e.jsx("h3",{className:"text-xl font-bold text-[#2E4D3A] mb-4",children:a}),e.jsx("ul",{className:"space-y-3",children:j.map((p,w)=>e.jsxs("li",{className:"flex flex-col gap-2 p-3 bg-[#F8F9FA] rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#2E4D3A]",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("time",{className:"font-semibold min-w-[56px]",children:p.time})]}),e.jsx("span",{className:"text-[#2F2F2F] font-medium",children:p.title})]}),p.description&&e.jsx("p",{className:"text-sm text-[#575757] ml-9",children:p.description}),e.jsx("div",{className:"flex items-center gap-2 ml-9 mt-1",children:p.is_trial_enabled?e.jsx("button",{onClick:()=>s(p,t),className:"text-sm font-semibold text-[#2E4D3A] underline hover:no-underline",children:"Agendar prueba"}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"inline-flex items-center gap-1 bg-gray-100 text-gray-500 rounded-full px-2.5 py-0.5 text-xs",children:[e.jsx(Z,{className:"w-3 h-3"})," No permite prueba"]}),e.jsx("button",{onClick:()=>c("/agenda-nave-studio"),className:"text-sm font-medium text-[#575757] underline hover:no-underline",children:"Agendar"})]})})]},w))})]},t)),U.length===0&&e.jsx("div",{className:"text-center py-12 text-[#575757]",children:e.jsx("p",{children:"No hay clases programadas para esta experiencia."})})]})]})})}const fe={domingo:0,lunes:1,martes:2,miercoles:3,jueves:4,viernes:5,sabado:6},je=s=>{const c=fe[s];if(c===void 0)return[];const d=new Date().toLocaleDateString("en-CA",{timeZone:O}),m=new Date(d+"T12:00:00"),r=new Date(m);r.setDate(r.getDate()+14);const l=[],o=new Date(m),i=(c-o.getDay()+7)%7;for(o.setDate(o.getDate()+(i===0?0:i));o<=r;)l.push(new Date(o)),o.setDate(o.getDate()+7);return l},Ne=s=>s.toLocaleDateString("es-CL",{weekday:"long",day:"numeric",month:"long",timeZone:O}),we=s=>{const c=s.getFullYear(),d=String(s.getMonth()+1).padStart(2,"0"),m=String(s.getDate()).padStart(2,"0");return`${c}-${d}-${m}`};function ve({classItem:s,dayKey:c,selectedDate:d,onSelectDate:m,onBack:r,onContinue:l}){const o=x.useMemo(()=>je(c),[c]);return e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-6",children:[e.jsxs("button",{onClick:r,className:"flex items-center gap-2 text-[#2E4D3A] font-medium mb-6 hover:underline",children:[e.jsx(G,{className:"w-5 h-5"}),"Volver"]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-[#E2E8F0] mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-[#2E4D3A] mb-3",children:s.title}),s.description&&e.jsx("p",{className:"text-[#575757] mb-4",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-[#575757]",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(ie,{className:"w-4 h-4 text-[#2E4D3A]"}),S[c]]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(R,{className:"w-4 h-4 text-[#2E4D3A]"}),s.time," hrs"]}),s.instructor&&e.jsxs("span",{className:"text-[#575757]",children:["con ",s.instructor]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-3 text-sm text-[#575757]",children:[e.jsx(ce,{className:"w-4 h-4 text-[#2E4D3A]"}),e.jsx("a",{href:"https://maps.app.goo.gl/YGMv9VjfZM6HPxEy8",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-[#2E4D3A]",children:"Antares 259, Las Condes"})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-[#2E4D3A] mb-4",children:"Selecciona una fecha"}),e.jsxs("div",{className:"space-y-3 mb-8",children:[o.length===0&&e.jsx("p",{className:"text-[#575757] text-sm",children:"No hay fechas disponibles en los prÃ³ximos 14 dÃ­as."}),o.map(i=>{const b=we(i),g=d===b;return e.jsxs("button",{onClick:()=>m(b),className:`w-full text-left rounded-xl px-5 py-4 font-medium transition-all border ${g?"bg-[#2E4D3A] text-white border-[#2E4D3A] shadow-sm":"bg-white text-[#2E4D3A] border-[#E2E8F0] hover:border-[#2E4D3A]/40 hover:bg-[#F8F9FA]"}`,children:[e.jsx("span",{className:"capitalize",children:Ne(i)}),e.jsxs("span",{className:"block text-sm mt-0.5 opacity-70",children:[s.time," hrs"]})]},b)})]}),e.jsx("button",{onClick:l,disabled:!d,className:"w-full bg-[#2E4D3A] text-white font-semibold py-4 rounded-xl text-lg hover:bg-[#2E4D3A]/90 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:"Continuar"})]})}const ye=me({name:L().trim().min(2,"Ingresa tu nombre").max(100),email:L().trim().email("Email invÃ¡lido").max(255),phone:L().trim().regex(/^\+?[0-9]{8,15}$/,"NÃºmero invÃ¡lido (ej: 912345678)")});function De({classItem:s,dayKey:c,selectedDate:d,onBack:m,onAlreadyAttended:r,onSuccess:l}){const[o,i]=x.useState(!1),{trackEvent:b}=z(),{trackServerEvent:g}=W(),u=de({resolver:xe(ye),defaultValues:{name:"",email:"",phone:""}}),f=()=>{const n=new URLSearchParams(window.location.search);return{utm_source:n.get("utm_source")||void 0,utm_medium:n.get("utm_medium")||void 0,utm_campaign:n.get("utm_campaign")||void 0}},N=async n=>{i(!0);try{const v=f(),{data:y,error:D}=await ne.functions.invoke("book-trial-class",{body:{customerName:n.name,customerEmail:n.email,customerPhone:n.phone,classTitle:s.title,dayKey:c,time:s.time,selectedDate:d,...v}});if(D)throw D;if(y!=null&&y.alreadyAttended){r();return}const A=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;b("TrialClass",{content_name:s.title,value:0,currency:"CLP"},A),g({eventName:"TrialClass",eventId:A,userEmail:n.email,userName:n.name,userPhone:n.phone,value:0,currency:"CLP",contentName:s.title}).catch(()=>{}),l()}catch(v){console.error("Booking error:",v),u.setError("root",{message:"Error al agendar. Intenta de nuevo."})}finally{i(!1)}},h=new Date(d+"T12:00:00").toLocaleDateString("es-CL",{weekday:"long",day:"numeric",month:"long",timeZone:"America/Santiago"});return e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-6",children:[e.jsxs("button",{onClick:m,className:"flex items-center gap-2 text-[#2E4D3A] font-medium mb-6 hover:underline",children:[e.jsx(G,{className:"w-5 h-5"}),"Volver"]}),e.jsxs("div",{className:"bg-[#F8F9FA] rounded-xl p-4 mb-6 border border-[#E2E8F0]",children:[e.jsx("p",{className:"font-semibold text-[#2E4D3A]",children:s.title}),e.jsxs("p",{className:"text-sm text-[#575757] capitalize",children:[h," Â· ",s.time," hrs"]})]}),e.jsx("h2",{className:"text-xl font-bold text-[#2E4D3A] mb-6",children:"Tus datos"}),e.jsx(ue,{...u,children:e.jsxs("form",{onSubmit:u.handleSubmit(N),className:"space-y-5",children:[e.jsx($,{control:u.control,name:"name",render:({field:n})=>e.jsxs(P,{children:[e.jsx(M,{className:"text-[#2E4D3A]",children:"Nombre"}),e.jsx(V,{children:e.jsx(T,{placeholder:"Tu nombre completo",...n})}),e.jsx(B,{})]})}),e.jsx($,{control:u.control,name:"email",render:({field:n})=>e.jsxs(P,{children:[e.jsx(M,{className:"text-[#2E4D3A]",children:"Email"}),e.jsx(V,{children:e.jsx(T,{type:"email",placeholder:"tu@email.com",...n})}),e.jsx(B,{})]})}),e.jsx($,{control:u.control,name:"phone",render:({field:n})=>e.jsxs(P,{children:[e.jsx(M,{className:"text-[#2E4D3A]",children:"Celular"}),e.jsx(V,{children:e.jsx(T,{type:"tel",placeholder:"912345678",...n})}),e.jsx(B,{})]})}),u.formState.errors.root&&e.jsx("p",{className:"text-sm text-red-600 font-medium",children:u.formState.errors.root.message}),e.jsxs("button",{type:"submit",disabled:o,className:"w-full bg-[#2E4D3A] text-white font-semibold py-4 rounded-xl text-lg hover:bg-[#2E4D3A]/90 transition-colors disabled:opacity-60 flex items-center justify-center gap-2",children:[o&&e.jsx(ae,{className:"w-5 h-5 animate-spin"}),"Confirmar clase de prueba"]})]})})]})}function Ae(){const s=H();return e.jsxs("div",{className:"max-w-md mx-auto px-4 py-16 text-center",children:[e.jsx("div",{className:"bg-amber-50 rounded-full w-16 h-16 mx-auto mb-6 flex items-center justify-center",children:e.jsx(he,{className:"w-8 h-8 text-amber-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-[#2E4D3A] mb-3",children:"Veo que ya hiciste tu clase de prueba"}),e.jsx("p",{className:"text-[#575757] mb-8",children:"La clase de prueba es solo una vez. Â¡Pero puedes seguir entrenando con nosotros!"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>s("/planes-precios"),className:"w-full bg-[#2E4D3A] text-white font-semibold py-4 rounded-xl text-lg hover:bg-[#2E4D3A]/90 transition-colors",children:"Ver planes"}),e.jsx("button",{onClick:()=>s("/agenda-nave-studio"),className:"w-full bg-white text-[#2E4D3A] font-semibold py-4 rounded-xl text-lg border border-[#2E4D3A] hover:bg-[#F8F9FA] transition-colors",children:"Agendar sesiÃ³n normal"})]})]})}function Ze(){const s=H(),{trackEvent:c}=z(),{trackServerEvent:d}=W(),[m,r]=x.useState("calendar"),[l,o]=x.useState(null),[i,b]=x.useState(""),[g,u]=x.useState(null);x.useEffect(()=>{const h=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;c("ViewContent",{content_name:"Clase de prueba",content_category:"Trial"},h),d({eventName:"ViewContent",eventId:h,contentName:"Clase de prueba"}).catch(()=>{})},[]);const f=()=>{if(l){const h=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;c("InitiateCheckout",{content_name:l.title,currency:"CLP",value:0},h),d({eventName:"InitiateCheckout",eventId:h,contentName:l.title,value:0,currency:"CLP"}).catch(()=>{})}r("form")},N=(h,n)=>{o(h),b(n),u(null),r("detail")};return m==="blocked"?e.jsxs(e.Fragment,{children:[e.jsx(_,{children:e.jsx("title",{children:"Clase de prueba | Nave Studio"})}),e.jsx(Ae,{})]}):m==="success"?e.jsxs(e.Fragment,{children:[e.jsx(_,{children:e.jsx("title",{children:"Â¡Clase agendada! | Nave Studio"})}),e.jsxs("div",{className:"max-w-md mx-auto px-4 py-16 text-center",children:[e.jsx("div",{className:"bg-emerald-50 rounded-full w-16 h-16 mx-auto mb-6 flex items-center justify-center",children:e.jsx(pe,{className:"w-8 h-8 text-emerald-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-[#2E4D3A] mb-3",children:"Â¡Clase de prueba agendada!"}),e.jsx("p",{className:"text-[#575757] mb-2",children:"Te enviamos un email con todos los detalles."}),e.jsxs("p",{className:"text-[#575757] mb-8",children:["Â¿Alguna duda?"," ",e.jsx("a",{href:"https://wa.me/56946120426",target:"_blank",rel:"noopener noreferrer",className:"text-[#2E4D3A] font-semibold underline",children:"EscrÃ­benos por WhatsApp"})]}),e.jsx("button",{onClick:()=>s("/"),className:"bg-[#2E4D3A] text-white font-semibold py-3 px-8 rounded-xl hover:bg-[#2E4D3A]/90 transition-colors",children:"Volver al inicio"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(_,{children:[e.jsx("title",{children:"Agendar clase de prueba | Nave Studio"}),e.jsx("meta",{name:"description",content:"Agenda tu clase de prueba gratis en Nave Studio. Yoga, HIIT, Breathwork y mÃ¡s en Las Condes."})]}),e.jsxs("div",{className:"min-h-screen bg-[#FAFAFA]",children:[e.jsxs("div",{className:"bg-[#2E4D3A] text-white py-8 px-4 text-center",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:"Agenda tu clase de prueba"}),e.jsx("p",{className:"text-white/80 text-sm md:text-base",children:"Elige una clase, selecciona fecha y reserva tu lugar"})]}),m==="calendar"&&e.jsx(ge,{onSelectClass:N}),m==="detail"&&l&&e.jsx(ve,{classItem:l,dayKey:i,selectedDate:g,onSelectDate:u,onBack:()=>r("calendar"),onContinue:f}),m==="form"&&l&&g&&e.jsx(De,{classItem:l,dayKey:i,selectedDate:g,onBack:()=>r("detail"),onAlreadyAttended:()=>r("blocked"),onSuccess:()=>r("success")})]})]})}export{Ze as default};
