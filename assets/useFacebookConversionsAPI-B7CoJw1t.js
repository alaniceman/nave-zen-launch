import{s as b}from"./index-DZgJ29pE.js";const I=()=>{const n=document.cookie.match(/_fbp=([^;]+)/);return n?n[1]:void 0},f=()=>{const n=document.cookie.match(/_fbc=([^;]+)/);if(n)return n[1];const t=new URLSearchParams(window.location.search).get("fbclid");if(t)return`fb.1.${Date.now()}.${t}`},P=()=>`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,C=()=>{const n=async({eventName:e,eventId:s,userEmail:u,userPhone:i,userName:d,value:v,currency:l,contentName:m,contentType:h,contentIds:k,orderId:N})=>{const r=s||P();try{const{data:o,error:c}=await b.functions.invoke("facebook-conversions",{body:{event_name:e,event_id:r,event_source_url:window.location.href,user_email:u,user_phone:i,user_name:d,value:v,currency:l||"CLP",content_name:m,content_type:h,content_ids:k,order_id:N,fbc:f(),fbp:I()}});c?console.error("Facebook Conversions API error:",c):console.log("Facebook Conversions API success:",o)}catch(o){console.error("Failed to send server event:",o)}return r};return{trackServerEvent:n,trackPurchase:async e=>n({eventName:"Purchase",eventId:e.eventId,userEmail:e.userEmail,userName:e.userName,userPhone:e.userPhone,value:e.value,currency:e.currency,contentName:e.contentName,contentType:"product",contentIds:[e.orderId],orderId:e.orderId}),trackInitiateCheckout:async e=>n({eventName:"InitiateCheckout",userEmail:e.userEmail,userName:e.userName,value:e.value,contentName:e.contentName}),trackLead:async e=>n({eventName:"Lead",userEmail:e.userEmail,userName:e.userName,userPhone:e.userPhone,contentName:e.contentName}),trackViewContent:async e=>n({eventName:"ViewContent",contentName:e.contentName,value:e.value})}};export{C as u};
